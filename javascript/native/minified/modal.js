
Event.observe(window,'load',function(){var teModalInt=new teModal();});teModal=Class.create({initialize:function(){this.show=this.show.bind(this);this.masterShow=this.masterShow.bind(this);this.teModalCLOSE=this.teModalCLOSE.bind(this);$$(this.modalClass).invoke('observe','click',this.show);},show:function(event){event.preventDefault();var linkClicked=event.findElement();if(typeof linkClicked=='undefined'){this.error(1);return false;}
this.title=linkClicked.readAttribute('title');this.mouseX=Event.pointerX(event);this.mouseY=Event.pointerY(event);var settings=[];var dataSplit=[];data=this.title.split(/, |,/);for(var ints=0;ints<data.length;ints++){dataSplit=data[ints].split(/: |:/);settings[dataSplit[0]]=dataSplit[1];}
var href;if(linkClicked.tagName=='A'){href=linkClicked.readAttribute('href');if(typeof href!==undefined){this.href=href;}else{this.errorHandler(6);}}else{if(settings.Type=='Ajax'){}
href=settings.Href;if(typeof href!==undefined){this.href=href;}else{this.errorHandler(6);}}
this.title=settings.Title;this.type=settings.Type;this.content=settings.Content;if(this.content=='Inline'){this.messageHolder=settings.Container;}
if(typeof settings.Validation!==undefined){this.validation=settings.Validation;}
if(typeof settings.Width!==undefined){this.width=settings.Width;}
if(typeof settings.Height!==undefined){this.height=settings.Height;}
if(typeof settings.Footer!==undefined){this.footer=settings.Footer;}
if(settings.Link=='check'&&typeof settings.Ref!==undefined){$('alert').action=href+'/'+settings.Ref;}
this.createModal();},alertModal:function(container){this.title=$(container).readAttribute('title');var titleData=this.title.split(/:::--:::/g);this.title=titleData[0];this.href=titleData[1];this.type=titleData[2];if(this.href=='inner'){this.innerData=$(container).innerHTML;}else{this.innerData=$(this.href).innerHTML;}
alert(this.innerData);this.dimensions=titleData[3].split(/x/g);if(typeof titleData[4]=='undefined'){this.footer=this.footerText;}else{this.footer=titleData[4];}
this.BG_open_end='0.0';this.createModal();teModalCLOSE=this.teModalCLOSE;setTimeout(function(){teModalCLOSE(['0.0','0.0']);},4000);},createModal:function(){this.getDimensions();var topMargin=(this.docDimensions.height*0.5)-(this.height*0.5);if(topMargin<0){topMargin=20;}
var leftMargin=((this.docDimensions.width)-this.width)/2;this.teBackground=new Element("div",{id:"teBackground"}).setStyle({display:'block',backgroundColor:this.bgColor,width:parseInt(this.browserDimensions[0])-17+'px',height:this.browserDimensions[1]+'px',opacity:0.0});holderHeight=parseInt(this.height)+20;if(this.type=='Alert'){topMargin=this.mouseY-(holderHeight*0.5);leftMargin=this.mouseX-(this.width*0.5);var dim=leftMargin+parseInt(this.width);if((leftMargin+this.width)>(this.browserDimensions[0]-(this.width*0.7))){leftMargin=this.browserDimensions[0]-(this.width*1.3);}}
this.teModalHolder=new Element("div",{id:"teModalHolder","class":"teModalRadius"}).setStyle({width:this.width+'px',height:holderHeight+'px',top:topMargin+'px',left:leftMargin+'px',opacity:0.0});this.teModalInnerHolder=new Element("div",{id:"teModalInnerHolder"});this.teModalHeader=new Element("div",{id:"teModalHeader"});this.teModalTitle=new Element("div",{id:"teModalTitle"});this.teModalClose=new Element("div",{id:"teModalClose"});this.teModalBodyWarper=new Element("div",{id:"teModalBodyWarper"});this.teModalBody=new Element("div",{id:"teModalBody"});this.teModalFooter=new Element("div",{id:"teModalFooter"}).setStyle({opacity:'0.0'});this.inject();},inject:function(){document.body.appendChild(this.teBackground);this.teBackground.insert({after:this.teModalHolder});this.teModalHolder.insert({top:this.teModalInnerHolder});this.teModalHolder.insert({top:this.teModalHeader});this.teModalHeader.insert({top:this.teModalTitle,bottom:this.teModalClose});this.teModalClose.update('<img src="'+this.closeModal+'" alt="modalClose" />');this.teModalInnerHolder.insert({bottom:this.teModalBodyWarper});this.teModalBodyWarper.insert({top:this.teModalBody});this.teModalHolder.insert({bottom:this.teModalFooter});this.teModalSHOW();},includeData:function(){if(this.type=='Ajax'){errorHandler=this.errorHandler;modalContent=this.content;modalValidation=this.validation;new Ajax.Request(this.href,{method:this.ajaxMethod,onComplete:function(response){var message=response.responseText;if(typeof message==undefined){errorHandler(4);}else{$('teModalBody').update(message);if(modalValidation&&modalContent=='Form'){var getForms=$$('.form-validate');if(getForms.length>0){var validate=new formValidation(getForms);}}}},onFailure:function(){errorHandler(5);return false;}});}else if(this.type=='Alert'){var updateData=$(this.messageHolder).innerHTML;teModalCLOSE=this.teModalCLOSE;$('teModalBody').update(updateData);var buttons=$$('input[type="button"].cancel');buttons.each(function(index){$(index).observe('click',function(event){buttonsHolder=Event.findElement(event);var form=$(buttonsHolder.id).up('form').id;if(buttonsHolder.id=='confirm'){$(form).submit();}else if(buttonsHolder.id=='cancel'){closeData=['0.0','0.0'];teModalCLOSE(closeData);}});})}},teModalSHOW:function(){this.teModalTitle.update(this.title);this.teModalFooter.update(this.footer);if(this.type!=='Alert'){if(this.BG_effectOrder!=='none'){this.masterShow('teBackground',this.BG_effectOrder,this.BG_parallelOptions,this.BG_effect,this.BG_effectParallel,this.BG_open_start,this.BG_open_end);}else{$('teBackground').setStyle({opacity:this.BG_open_end});}}else{this.modal_effectOrder='none';}
if(this.modal_effectOrder!=='none'){this.masterShow('teModalHolder',this.modal_effectOrder,this.modal_parallelOptions,this.modal_effect,this.modal_effectParallel,this.modal_open_start,this.modal_open_end);}else{$('teModalHolder').setStyle({opacity:this.modal_open_end});}
this.includeData();if(this.draggable){new Draggable('teModalHolder',{handle:'teModalHeader'});this.teModalHeader.setStyle({cursor:'move'});}
$('teModalClose','teBackground').invoke('observe','click',this.teModalCLOSE);},teModalCLOSE:function(data){if(data){this.BG_close_end=data[0];this.BG_close_start=data[1];}
if(this.modal_effectOrder!=='none'){this.masterShow('teModalHolder',this.modal_effectOrder,this.modal_parallelOptions,this.modal_effectClose,this.modal_effectCloseParallel,this.modal_close_start,this.modal_close_end);}else{$('teModalHolder').setStyle({opacity:this.modal_close_end});}
if(this.BG_effectOrder!=='none'){this.masterShow.delay(this.delayTime,'teBackground',this.BG_effectOrder,this.BG_parallelOptions,this.BG_effectClose,this.BG_effectCloseParallel,this.BG_close_start,this.BG_close_end,this.removeModal);}else{$('teBackground').setStyle({opacity:this.BG_close_end});}
if(this.type!=='alert'){$('teModalClose','teBackground').invoke('stopObserving');}},removeModal:function(){$('teModalHolder').remove();$('teBackground').remove();delete this.teBackground;delete this.teModalHolder;},masterShow:function(Selector,Options,OptionsParalell,EffectMaster,EffectParallel,startOpacity,endOpacity,afterFinishFunction){var removeModal=this.removeModal;this.effectsOptions[EffectMaster].opt.to=endOpacity;this.effectsOptions[EffectMaster].opt.from=startOpacity;if(typeof afterFinishFunction!=='undefined'){this.effectsOptions[EffectMaster].opt.afterFinish=function(){removeModal();};}
if(Options=='single'){new this.effectsOptions[EffectMaster].effect(Selector,this.effectsOptions[EffectMaster].opt);}else if(Options=='parallel'){if(OptionsParalell=='separate'){var parallelOptions={};}else if(OptionsParalell=='together'){delete this.effectsOptions[EffectMaster].opt.duration;delete this.effectsOptions[EffectParallel].opt.duration;this.effectsOptions[EffectMaster].opt.sync=true;this.effectsOptions[EffectParallel].opt.sync=true;var parallelOptions={duration:this.duration};}
new Effect.Parallel([new this.effectsOptions[EffectMaster].effect(Selector,this.effectsOptions[EffectMaster].opt),new this.effectsOptions[EffectParallel].effect(Selector,this.effectsOptions[EffectParallel].opt),],parallelOptions);}else if(Options=='serial'){this.effectsOptions[EffectMaster].effect.queue='front';this.effectsOptions[EffectParallel].effect.queue='end';new this.effectsOptions[EffectMaster].effect(Selector,this.effectsOptions[EffectMaster].opt);new this.effectsOptions[EffectParallel].effect(Selector,this.effectsOptions[EffectParallel].opt);}},getDimensions:function(){this.docDimensions=document.viewport.getDimensions();this.browserDimensions=[];this.browserDimensions[0]=window.screen.availWidth;this.browserDimensions[1]=window.screen.availHeight;},error:function(error){switch(error){case 1:errorInfo='Element is not defined.';break;case 1:errorInfo='For now this modal support only <b>a</b> tag.';break;}}});teModal.addMethods({modalClass:'.modal',bgColor:'#000',maxWidth:0.7,maxHeight:0.7,opacity:'0.7',duration:'2.0',delayTime:1.0,backroundClose:true,closeModal:'project/media/core/icons/effects/icon_close.png',preloader:'project/themes/admin/master/images/loading.gif',ajaxMethod:'post',draggable:true,footerText:'teModal',validation:false,preloaderId:'tePreloader',outerRadius:120,innerRadius:70,dashesNumber:12,dashesWidth:25,dashesColor:'#ccc',BG_effectOrder:'single',BG_parallelOptions:'separate',BG_effect:'appear',BG_effectParallel:'blindDown',BG_effectClose:'fade',BG_effectCloseParallel:'blindUp',BG_open_start:0.0,BG_open_end:0.7,BG_close_start:0.7,BG_close_end:0.0,modal_effectOrder:'single',modal_parallelOptions:'separate',modal_effect:'appear',modal_effectParallel:'blindDown',modal_effectClose:'fade',modal_effectCloseParallel:'blindUp',modal_open_start:0.0,modal_open_end:1.0,modal_close_start:1.0,modal_close_end:0.0,effectsOptions:{highlight:{effect:Effect.Highlight,opt:{startcolor:'#ffff99',endcolor:'#ffffff',restorecolor:'',keepBackgroundImage:true,duration:2.0}},morph:{effect:Effect.Morph,opt:{duration:2.0}},move:{effect:Effect.Move,opt:{x:50,y:50,mode:'relative',duration:2.0}},oppacityUp:{effect:Effect.Opacity,opt:{from:0.0,to:1.0,duration:2.0}},oppacityDown:{effect:Effect.Opacity,opt:{from:1.0,to:0.0,duration:2.0}},scale:{effect:Effect.Scale,opt:{scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:'box',scaleFrom:100,duration:2.0}},appear:{effect:Effect.Appear,opt:{from:0.0,to:1.0,duration:2.0}},blindDown:{effect:Effect.BlindDown,opt:{scaleX:false,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:'box',scaleFrom:100,scaleTo:0,duration:2.0}},blindUp:{effect:Effect.BlindUp,opt:{scaleX:false,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:'box',scaleFrom:100,scaleTo:0,duration:2.0}},blindRight:{effect:Effect.BlindRight,opt:{scaleX:false,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:'box',scaleFrom:100,scaleTo:0,duration:2.0}},blindLeft:{effect:Effect.BlindLeft,opt:{scaleX:false,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:'box',scaleFrom:100,scaleTo:0,duration:2.0}},dropOut:{effect:Effect.DropOut,opt:{duration:2.0}},fade:{effect:Effect.Fade,opt:{from:1.0,to:0.0,duration:2.0}},fold:{effect:Effect.Fold,opt:{duration:2.0}},grow:{effect:Effect.Grow,opt:{duration:2.0}},puff:{effect:Effect.Puff,opt:{from:0.0,to:1.0,duration:2.0}},pulsate:{effect:Effect.Pulsate,opt:{from:0.0,pulses:5,duration:2.0}},shake:{effect:Effect.Shake,opt:{duration:0.5,distance:20,duration:2.0}},shrink:{effect:Effect.Shrink,opt:{direction:'center',duration:2.0}},slideDown:{effect:Effect.SlideDown,opt:{scaleX:false,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:'box',scaleFrom:100,scaleTo:0,duration:2.0}},slideUp:{effect:Effect.SlideUp,opt:{scaleX:false,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:'box',scaleFrom:100,scaleTo:0,duration:2.0}},squish:{effect:Effect.Squish,opt:{direction:'center',duration:2.0}},switchOff:{effect:Effect.SwitchOff,opt:{duration:2.0}},ScrollTo:{effect:Effect.ScrollTo,opt:{offset:0,duration:2.0}}}});